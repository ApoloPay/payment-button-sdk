---
import type { HTMLAttributes } from "astro/types";

import type {
  ClientResponse,
  ClientError,
  Locale,
} from "@payment-button-sdk/ui";

interface Props extends HTMLAttributes<"div"> {
  publicKey: string;
  amount: number;
  metadata?: Record<string, any>;
  productTitle?: string;
  lang?: Locale;
  disabled?: boolean;
  loading?: boolean;
  label?: string;
  barrierDismissible?: boolean;
  onSuccess?: (event: CustomEvent<ClientResponse>) => void;
  onError?: (event: CustomEvent<ClientError>) => void;
}

const {
  publicKey,
  amount,
  metadata,
  productTitle,
  lang,
  disabled,
  loading,
  label,
  barrierDismissible,
  ...restProps
} = Astro.props;
const hasContent = Astro.slots.has("default");
---

{
  hasContent ? (
    <payment-button
      public-key={publicKey}
      amount={amount}
      metadata={metadata}
      product-title={productTitle}
      lang={lang}
      disabled={disabled}
      loading={loading}
      label={label}
      barrier-dismissible={barrierDismissible}
      {...restProps}
    >
      <slot />
    </payment-button>
  ) : (
    <payment-button
      public-key={publicKey}
      amount={amount}
      metadata={metadata}
      product-title={productTitle}
      lang={lang}
      disabled={disabled}
      loading={loading}
      label={label}
      barrier-dismissible={barrierDismissible}
      {...restProps}
    />
  )
}

<script>
  import "@payment-button-sdk/ui";
</script>
