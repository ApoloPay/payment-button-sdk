---
import type { HTMLAttributes } from 'astro/types';

import type { PaymentResponse, PaymentError, Locale } from '@payment-button-sdk/ui';

interface Props extends HTMLAttributes<'div'> {
  apiKey: string;
  amount: number;
  email: string;
  productTitle?: string;
  lang?: Locale;
  disabled?: boolean;
  loading?: boolean;
  label?: string;
  barrierDismissible?: boolean;
  onSuccess?: (event: CustomEvent<PaymentResponse>) => void;
  onError?: (event: CustomEvent<PaymentError>) => void;
}

const { apiKey, amount, email, productTitle, lang, disabled, loading, label, barrierDismissible, ...restProps } = Astro.props;
const hasContent = Astro.slots.has('default');
---

{
  hasContent ? (
    <payment-button
      api-key={apiKey}
      amount={amount}
      email={email}
      product-title={productTitle}
      lang={lang}
      disabled={disabled}
      loading={loading}
      label={label}
      barrier-dismissible={barrierDismissible}
      {...restProps}
    >
      <slot />
    </payment-button>
  ) : (
    <payment-button
      api-key={apiKey}
      amount={amount}
      email={email}
      product-title={productTitle}
      lang={lang}
      disabled={disabled}
      loading={loading}
      label={label}
      barrier-dismissible={barrierDismissible}
      {...restProps}
    />
  )
}

<script>
  import '@payment-button-sdk/ui';
</script>